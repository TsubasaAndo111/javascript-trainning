## マルチスレッドについて調べなさい

マルチスレッドとは、1つのプロセスの中で複数のスレッド（軽量な処理単位）を同時に実行する仕組み

プロセスは「アプリ全体」、スレッドは「その中の作業担当者」のイメージ。

論理コア数（物理コア＋Hyper-Threading）は、CPUが同時に実行できるスレッド数

メリット

- 処理の高速化（CPUコアを有効活用）
- 応答性の向上（UI操作とバックグラウンド処理を分離）

注意点

- スレッド間でメモリを共有するため、同期や排他制御が必要（デッドロックとかを防ぐために）。
- スレッド数が多すぎると逆にオーバーヘッドが増える。(同時に実行できるスレッド数には物理的制限があり、スレッドの管理に負荷がかかるため。頻繁にスケジューリングするとか。)

処理の種類で最適なスレッド数が異なる

- I/Oバウンドの場合

  I/O処理（ネットワーク、ディスクアクセスなど）はCPUを使わず待機する時間が多い。

  そのため、CPUが暇になる時間があるので、論理コア数を超えるスレッドを作っても効率が良い。

  例：8論理コアでも、I/O待ちが多いなら16～32スレッドでもOK。

- CPUバウンドの場合

  計算処理がメインで、CPUをフルに使うなら、論理コア数以上にスレッドを増やしても意味がない

  例：8論理コアなら、8スレッド程度が最適。

## 次にフィボナッチ数を計算するmFib.jsをスレッド数を変更しながら実行し(*1)、コンソール出力とOS機能(*2)で結果とスレッド数を確認しなさい。

リソースモニターのnode.exeのスレッド数を確認

node.exe本来のスレッド数が16で、残りがmFib.jsの実行に使用しているスレッドだと思われる。

45 1 スレッド数17 18.979s

45 2 スレッド数18 12.783s

45 4 スレッド数20 10.057s

45 8 スレッド数24 9.291s

45 10 スレッド数26 9.185s

45 12 スレッド数28 10.445s

45 16 スレッド数32 11.879s

## 最後にあなたのPCのCPUスペックを調査し、適切なスレッド数についての考察を記しなさい。

PCのCPU：13th Gen Intel(R) Core(TM) i5-1345U 1.60 GHz

物理コア数が10、論理スレッド数が12となっているため、今回のようにプログラム内だけで演算を行う場合は、最大スレッド数である12とするのが適切であると考える。

また、上記の実行でもスレッド数12が最も実行時間が短くなった。

https://www.intel.co.jp/content/www/jp/ja/products/sku/232127/intel-core-i51345u-processor-12m-cache-up-to-4-70-ghz/specifications.html
